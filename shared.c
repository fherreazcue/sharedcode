refactored from shared
added some bits
Hi from R1
